(this.webpackJsonpposenet=this.webpackJsonpposenet||[]).push([[0],{11:function(e,t,n){e.exports=n(18)},16:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(8),o=n.n(c),i=(n(16),n(6)),u=n(4),s=n.n(u),l=n(9),d=n(1),h=n(10),f=n(5),m=n(2),p={app:{height:"100vh",backgroundColor:"#282c34",flexDirection:"column"},header:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"white"},count:{zIndex:10,color:"#61dafb"},video:{display:"none"},canvas:{top:"80%"}};var g=function(){var e=Object(r.useRef)(null),t=Object(r.useRef)(null),n={width:640,height:360},c=Object(r.useState)(0),o=Object(d.a)(c,2),u=o[0],g=o[1],v=Object(r.useState)(0),w=Object(d.a)(v,2),b=w[0],O=w[1],j=Object(r.useRef)({left:!1,right:!1}),k=Object(r.useRef)(!1),y=Object(r.useState)(null),x=Object(d.a)(y,2),E=x[0],L=x[1],M=Object(r.useState)(null),S=Object(d.a)(M,2),C=S[0],T=S[1],R=Object(r.useState)(null),I=Object(d.a)(R,2),q=I[0],D=I[1],F=Object(r.useState)(10),W=Object(d.a)(F,2),B=W[0],N=W[1],P=Object(r.useRef)(null);function z(){clearTimeout(C),clearTimeout(q),T(null),D(null)}function J(t){var n=e.current.getContext("2d");n.save(),n.clearRect(0,0,e.current.width,e.current.height),n.drawImage(t.image,0,0,e.current.width,e.current.height),Object(m.drawConnectors)(n,t.poseLandmarks,f.POSE_CONNECTIONS,{color:"#F5E07E",lineWidth:2}),Object(m.drawLandmarks)(n,t.poseLandmarks,{color:"#223BE9",lineWidth:1,radius:2});var r=P.current.getContext("2d");if(r.clearRect(0,0,P.current.width,P.current.height),B>0&&(r.font="30px Arial",r.fillStyle="white",r.fillText("Starting in ".concat(B),10,50)),t.poseLandmarks){var a=t.poseLandmarks[11],c=t.poseLandmarks[12],o=t.poseLandmarks[13],i=t.poseLandmarks[14],u=t.poseLandmarks[15],s=t.poseLandmarks[16],l=U(a,o,u),d=U(c,i,s);l>160&&(j.current.left="down"),l<30&&"down"===j.current.left&&(j.current.left="up"),d>160&&(j.current.right="down"),d<30&&"down"===j.current.right&&(j.current.right="up"),"up"===j.current.left&&"up"===j.current.right&&(g((function(e){return e+1})),L("curl"),j.current.left=!1,j.current.right=!1);var h=t.poseLandmarks[23],p=t.poseLandmarks[24],v=t.poseLandmarks[25],w=t.poseLandmarks[26],b=t.poseLandmarks[27],y=t.poseLandmarks[28],x=U(h,v,b),E=U(p,w,y);x<120&&E<120&&(k.current=!0),x>160&&E>160&&k.current&&(O((function(e){return e+1})),L("squat"),k.current=!1)}n.restore()}function U(e,t,n){var r=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),c=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2));return Math.acos((r*r+a*a-c*c)/(2*r*a))*(180/Math.PI)}return Object(r.useEffect)((function(){var e=new f.Pose({locateFile:function(e){return"https://cdn.jsdelivr.net/npm/@mediapipe/pose/".concat(e)}});return e.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!0,smoothSegmentation:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),e.onResults(J),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:n}).then((function(r){t.current.srcObject=r,t.current.onloadedmetadata=function(){setTimeout((function(){new h.Camera(t.current,{onFrame:function(){var n=Object(l.a)(s.a.mark((function n(){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.send({image:t.current});case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),width:n.width,height:n.height}).start()}),1e4)}})).catch((function(e){console.error("Failed to get user media",e)})),function(){e.close()}}),[J,n]),Object(r.useEffect)((function(){if(E||(O(0),g(0),j.current={left:!1,right:!1},k.current=!1),"squat"===E&&!C){var e=setTimeout((function(){L("curl"),z()}),5e3);T(e)}if("curl"===E&&!q){var t=setTimeout((function(){L("squat"),z()}),5e3);D(t)}}),[E,C,q,z]),Object(r.useEffect)((function(){if(B>0){var e=setTimeout((function(){N((function(e){return e-1}))}),1e3);return console.log(B),function(){return clearTimeout(e)}}}),[B]),Object(r.useCallback)(J,[]),a.a.createElement("div",{style:p.app},a.a.createElement("header",{style:p.header},a.a.createElement("video",{ref:t,style:p.video}),a.a.createElement("canvas",{ref:P,style:Object(i.a)(Object(i.a)({},p.canvas),{},{zIndex:10})}),a.a.createElement("canvas",{ref:e,style:{top:"80%",width:n.width,height:n.height}}),a.a.createElement("h1",{style:p.count},"\u30a2\u30fc\u30e0\u30ab\u30fc\u30eb\u306e\u56de\u6570\uff1a ",u),a.a.createElement("h1",{style:p.count},"\u30b9\u30af\u30ef\u30c3\u30c8\u306e\u56de\u6570\uff1a ",b)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(g,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[11,1,2]]]);
//# sourceMappingURL=main.752b6a28.chunk.js.map