(this.webpackJsonpposenet=this.webpackJsonpposenet||[]).push([[0],{10:function(e,t,n){e.exports=n(17)},15:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(7),c=n.n(o),i=(n(15),n(4)),s=n.n(i),u=n(8),l=n(1),d=n(9),h=n(5),m=n(2),f={app:{height:"100vh",backgroundColor:"#282c34",flexDirection:"column"},header:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"white"},count:{zIndex:10,color:"#61dafb"},video:{display:"none"},canvas:{top:"80%"}};var p=function(){var e=Object(r.useRef)(null),t=Object(r.useRef)(null),n={width:640,height:360},o=Object(r.useState)(0),c=Object(l.a)(o,2),i=c[0],p=c[1],g=Object(r.useState)(0),v=Object(l.a)(g,2),w=v[0],b=v[1],k=Object(r.useRef)({left:!1,right:!1}),O=Object(r.useRef)(!1),j=Object(r.useState)(null),y=Object(l.a)(j,2),E=y[0],L=y[1],x=Object(r.useState)(null),M=Object(l.a)(x,2),C=M[0],S=M[1],q=Object(r.useState)(null),D=Object(l.a)(q,2),I=D[0],R=D[1];function T(){clearTimeout(C),clearTimeout(I),S(null),R(null)}function F(t){var n=e.current.getContext("2d");if(n.save(),n.clearRect(0,0,e.current.width,e.current.height),n.drawImage(t.image,0,0,e.current.width,e.current.height),Object(m.drawConnectors)(n,t.poseLandmarks,h.POSE_CONNECTIONS,{color:"#F5E07E",lineWidth:2}),Object(m.drawLandmarks)(n,t.poseLandmarks,{color:"#223BE9",lineWidth:1,radius:2}),t.poseLandmarks){var r=t.poseLandmarks[11],a=t.poseLandmarks[12],o=t.poseLandmarks[13],c=t.poseLandmarks[14],i=t.poseLandmarks[15],s=t.poseLandmarks[16],u=W(r,o,i),l=W(a,c,s);u>160&&(k.current.left="down"),u<30&&"down"===k.current.left&&(k.current.left="up"),l>160&&(k.current.right="down"),l<30&&"down"===k.current.right&&(k.current.right="up"),"up"===k.current.left&&"up"===k.current.right&&(p((function(e){return e+1})),L("curl"),k.current.left=!1,k.current.right=!1);var d=t.poseLandmarks[23],f=t.poseLandmarks[24],g=t.poseLandmarks[25],v=t.poseLandmarks[26],w=t.poseLandmarks[27],j=t.poseLandmarks[28],y=W(d,g,w),E=W(f,v,j);y<90&&E<90&&(O.current=!0),y>160&&E>160&&O.current&&(b((function(e){return e+1})),L("squat"),O.current=!1)}n.restore()}function W(e,t,n){var r=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),o=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2));return Math.acos((r*r+a*a-o*o)/(2*r*a))*(180/Math.PI)}return Object(r.useEffect)((function(){var e=new h.Pose({locateFile:function(e){return"https://cdn.jsdelivr.net/npm/@mediapipe/pose/".concat(e)}});return e.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!0,smoothSegmentation:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),e.onResults(F),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:n}).then((function(r){t.current.srcObject=r,t.current.onloadedmetadata=function(){new d.Camera(t.current,{onFrame:function(){var n=Object(u.a)(s.a.mark((function n(){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.send({image:t.current});case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),width:n.width,height:n.height}).start()}})).catch((function(e){console.error("Failed to get user media",e)})),function(){e.close()}}),[]),Object(r.useEffect)((function(){if(E||(b(0),p(0),k.current={left:!1,right:!1},O.current=!1),"squat"===E&&!C){var e=setTimeout((function(){L("curl"),T()}),5e3);S(e)}if("curl"===E&&!I){var t=setTimeout((function(){L("squat"),T()}),5e3);R(t)}}),[E,C,I]),a.a.createElement("div",{style:f.app},a.a.createElement("header",{style:f.header},a.a.createElement("video",{ref:t,style:f.video}),a.a.createElement("canvas",{ref:e,style:f.canvas}),a.a.createElement("canvas",{ref:e,style:{top:"80%",width:n.width,height:n.height}}),a.a.createElement("h1",{style:f.count},"\u30a2\u30fc\u30e0\u30ab\u30fc\u30eb\u306e\u56de\u6570\uff1a ",i),a.a.createElement("h1",{style:f.count},"\u30b9\u30af\u30ef\u30c3\u30c8\u306e\u56de\u6570\uff1a ",w)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(p,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[10,1,2]]]);
//# sourceMappingURL=main.0876a268.chunk.js.map